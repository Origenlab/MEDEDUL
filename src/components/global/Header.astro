---
// Header Component - Main navigation
import { getCdnUrl } from '@/lib/cdn';

interface Props {
  currentPath?: string;
}

const { currentPath = '/' } = Astro.props;
---

<header class="header">
  <div class="container">
    <nav class="nav">
      <a href="/" class="logo">
        <img
          src={getCdnUrl("/img/branding/logo-mededul-mesas-de-dulces.avif")}
          alt="Mededul - Mesas de Dulces CDMX"
          width="200"
          height="68"
          loading="eager"
        />
      </a>

      <ul class="nav-menu" id="navMenu">
        <li class="nav-item">
          <a href="/" class="nav-link" class:list={[{ active: currentPath === '/' }]}>Inicio</a>
        </li>

        <li class="nav-dropdown">
          <a href="/servicios" class="nav-link nav-link-dropdown">
            Servicios
            <svg width="10" height="10" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="6 9 12 15 18 9"/>
            </svg>
          </a>
          <ul class="dropdown-menu dropdown-mega">
            <div class="dropdown-column">
              <span class="dropdown-header">Tipos de Mesa</span>
              <ul>
                <li><a href="/tipos-de-mesas/mesa-de-dulces-clasica">Mesa Clásica</a></li>
                <li><a href="/tipos-de-mesas/mesa-de-dulces-premium">Mesa Premium</a></li>
                <li><a href="/tipos-de-mesas/mesa-de-dulces-tematica">Mesa Temática</a></li>
                <li><a href="/tipos-de-mesas/mesa-de-dulces-infantil">Mesa Infantil</a></li>
              </ul>
              <a href="/tipos-de-mesas" class="ver-todos">Ver Todos</a>
            </div>
            <div class="dropdown-column">
              <span class="dropdown-header">Eventos</span>
              <ul>
                <li><a href="/candy-bar-eventos/mesa-dulces-bodas">Bodas</a></li>
                <li><a href="/candy-bar-eventos/mesa-dulces-xv-anos">XV Años</a></li>
                <li><a href="/candy-bar-eventos/mesa-dulces-baby-shower">Baby Shower</a></li>
                <li><a href="/candy-bar-eventos/mesa-dulces-bautizos">Bautizos</a></li>
              </ul>
              <a href="/candy-bar-eventos" class="ver-todos">Ver Todos</a>
            </div>
            <div class="dropdown-column">
              <span class="dropdown-header">Estaciones</span>
              <ul>
                <li><a href="/estaciones-interactivas/fuente-de-chocolate">Fuente de Chocolate</a></li>
                <li><a href="/estaciones-interactivas/barra-de-palomitas">Barra de Palomitas</a></li>
                <li><a href="/estaciones-interactivas/estacion-de-helados">Estación de Helados</a></li>
                <li><a href="/estaciones-interactivas/barra-de-nachos">Barra de Nachos</a></li>
              </ul>
              <a href="/estaciones-interactivas" class="ver-todos">Ver Todos</a>
            </div>
          </ul>
        </li>

        <li class="nav-dropdown">
          <a href="/porque-mededul" class="nav-link nav-link-dropdown">
            ¿Por qué Mededul?
            <svg width="10" height="10" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="6 9 12 15 18 9"/>
            </svg>
          </a>
          <ul class="dropdown-menu">
            <li><a href="/porque-mededul/calidad-premium">Calidad Premium</a></li>
            <li><a href="/porque-mededul/servicio-personalizado">Servicio Personalizado</a></li>
            <li><a href="/porque-mededul/experiencia-garantizada">Experiencia Garantizada</a></li>
            <li><a href="/porque-mededul/precios-transparentes">Precios Transparentes</a></li>
            <li class="dropdown-divider"></li>
            <li><a href="/porque-mededul" class="ver-todos">Ver Todos</a></li>
          </ul>
        </li>

        <li class="nav-item">
          <a href="/blog" class="nav-link" class:list={[{ active: currentPath.startsWith('/blog') }]}>Blog</a>
        </li>

        <li class="nav-item">
          <a href="/contacto" class="nav-link" class:list={[{ active: currentPath === '/contacto' }]}>Contacto</a>
        </li>
      </ul>

      <div class="nav-actions">
        <a href="tel:+525525226442" class="nav-phone">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M22 16.92v3a2 2 0 01-2.18 2 19.79 19.79 0 01-8.63-3.07 19.5 19.5 0 01-6-6 19.79 19.79 0 01-3.07-8.67A2 2 0 014.11 2h3a2 2 0 012 1.72 12.84 12.84 0 00.7 2.81 2 2 0 01-.45 2.11L8.09 9.91a16 16 0 006 6l1.27-1.27a2 2 0 012.11-.45 12.84 12.84 0 002.81.7A2 2 0 0122 16.92z"/>
          </svg>
          <span>55 2522 6442</span>
        </a>
        <a href="/contacto" class="btn-cta-nav">Cotiza Gratis</a>
      </div>

      <button class="hamburger" id="hamburger" aria-label="Abrir menú">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </nav>
  </div>
</header>

<script>
  // Mobile menu toggle
  const hamburger = document.getElementById('hamburger');
  const navMenu = document.getElementById('navMenu');

  hamburger?.addEventListener('click', () => {
    hamburger.classList.toggle('active');
    navMenu?.classList.toggle('active');
  });

  // Mobile dropdown toggles
  const dropdowns = document.querySelectorAll('.nav-dropdown');

  dropdowns.forEach(dropdown => {
    const link = dropdown.querySelector('.nav-link-dropdown');

    link?.addEventListener('click', (e) => {
      if (window.innerWidth <= 768) {
        e.preventDefault();
        dropdown.classList.toggle('active');

        // Close other dropdowns
        dropdowns.forEach(other => {
          if (other !== dropdown) {
            other.classList.remove('active');
          }
        });
      }
    });
  });

  // Mobile dropdown column toggles
  const dropdownColumns = document.querySelectorAll('.dropdown-column');

  dropdownColumns.forEach(column => {
    const header = column.querySelector('.dropdown-header');

    header?.addEventListener('click', (e) => {
      if (window.innerWidth <= 768) {
        e.stopPropagation();
        column.classList.toggle('active');
      }
    });
  });
</script>
